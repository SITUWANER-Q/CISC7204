name: Deploy Static HTML to GitHub Pages

# 触发条件：推送到 main 分支时自动运行，也支持手动触发
on:
  push:
    branches: [ main ]
  workflow_dispatch:  # 允许在 GitHub 界面手动触发工作流

# 权限配置：确保有足够权限创建/更新 gh-pages 分支
permissions:
  contents: read  # 允许读取仓库代码
  pages: write    # 允许写入 Pages 部署内容
  id-token: write # 允许生成身份令牌（用于部署验证）

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      # 步骤 1：拉取仓库代码（确保能获取到 index.html）
      - name: Checkout repository code
        uses: actions/checkout@v4  # 官方拉取代码动作，稳定可靠

      # 步骤 2：部署到 GitHub Pages（关键：使用正确的动作名称）
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4  # 正确的部署动作（非 actions/deploy-github-pages）
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}  # 自动生成的令牌，无需手动配置
          publish_dir: ./  # 部署根目录的所有文件（确保 index.html 在根目录）
          force_orphan: true  # 强制创建独立的 gh-pages 分支，避免历史文件冲突
          enable_jekyll: false  # 禁用 Jekyll 处理（纯静态 HTML 无需 Jekyll）
